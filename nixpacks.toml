[phases.setup]
nixPkgs = [
  "python311",
  "cairo",
  "pango",
  "harfbuzz",
  "fontconfig",
  "gdk-pixbuf",
  "glib",
  "gobject-introspection",
  "libffi",
  "pkg-config"
]

[phases.install]
cmds = [
  "python3 -m venv --copies /opt/venv",
  ". /opt/venv/bin/activate",
  "pip install --no-cache-dir -r requirements.txt"
]

[start]
cmd = "export LD_LIBRARY_PATH=/root/.nix-profile/lib:/nix/var/nix/profiles/default/lib:$LD_LIBRARY_PATH && export GI_TYPELIB_PATH=/root/.nix-profile/lib/girepository-1.0:$GI_TYPELIB_PATH && uvicorn main:app --host 0.0.0.0 --port $PORT"

